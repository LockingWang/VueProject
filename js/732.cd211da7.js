"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[732],{4798:function(e,t,a){a.d(t,{Z:function(){return x}});var o=a(3396),n=a(7139),s=a(9242);const l={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},i={class:"modal-dialog",role:"document"},d={class:"modal-content border-0"},p={class:"modal-header bg-danger text-white"},u={class:"modal-title"},c=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),r={class:"modal-body"},m={class:"text-danger"},h=(0,o._)("br",null,null,-1),g={key:0,class:"mt-3"},_={for:"delPassword"},b={key:0,class:"text-danger mb-0"},f={class:"modal-footer"},v=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function C(e,t,a,C,w,y){return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",i,[(0,o._)("div",d,[(0,o._)("div",p,[(0,o._)("h5",u,[(0,o._)("span",null,"刪除 "+(0,n.zw)(a.item.title),1)]),c]),(0,o._)("div",r,[(0,o.Uk)(" 是否刪除 "),(0,o._)("strong",m,(0,n.zw)(a.item.title),1),(0,o.Uk)(),h,(0,o.Uk)("(刪除後將無法恢復)。 "),"全部訂單"===a.item.title?((0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("label",_,[(0,o.Uk)(" 請輸入 [ delete1314 ] ，確認刪除所有訂單。 "),(0,o.wy)((0,o._)("input",{id:"delPassword",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>w.delKey=e)},null,512),[[s.nr,w.delKey]]),w.wrongKey?((0,o.wg)(),(0,o.iD)("p",b,"輸入錯誤，請謹慎輸入 !")):(0,o.kq)("",!0)])])):(0,o.kq)("",!0)]),(0,o._)("div",f,[v,(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=(...e)=>y.deleteTarget&&y.deleteTarget(...e))},"確認刪除 ")])])])],512)}var w=a(1339),y={props:{item:{}},data(){return{modal:{},delKey:"",wrongKey:!1}},methods:{deleteTarget(){"全部訂單"===this.item.title?"delete1314"===this.delKey?this.$emit("del-all"):this.wrongKey=!0:this.$emit("del-item")}},mixins:[w.Z]},k=a(89);const M=(0,k.Z)(y,[["render",C]]);var x=M},5239:function(e,t,a){a.d(t,{Z:function(){return b}});var o=a(3396),n=a(7139),s=a(9242);const l={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center"},d=(0,o._)("span",{"aria-hidden":"true"},"«",-1),p=[d],u=["onClick"],c=(0,o._)("span",{"aria-hidden":"true"},"»",-1),r=[c];function m(e,t,a,d,c,m){return(0,o.wg)(),(0,o.iD)("nav",l,[(0,o._)("ul",i,[(0,o._)("li",{class:(0,n.C_)(["page-item",{"page-link-disabled":!a.pages.has_pre}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,s.iM)((e=>m.updatePage("previous")),["prevent"]))},p)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.pages.total_pages,(e=>((0,o.wg)(),(0,o.iD)("li",{class:(0,n.C_)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,o._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((t=>m.updatePage(e)),["prevent"])},(0,n.zw)(e),9,u)],2)))),128)),(0,o._)("li",{class:(0,n.C_)(["page-item",{"page-link-disabled":!a.pages.has_next}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,s.iM)((e=>m.updatePage("next")),["prevent"]))},r)],2)])])}var h={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)}}},g=a(89);const _=(0,g.Z)(h,[["render",m]]);var b=_},6732:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var o=a(3396),n=a(7139);const s={class:"row g-3 mt-3 justify-content-end"},l={class:"col-sm-3"},i={class:"overflow-auto"},d={class:"table mt-4 text-nowrap"},p=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"名稱"),(0,o._)("th",null,"折扣百分比(%)"),(0,o._)("th",null,"到期日"),(0,o._)("th",null,"是否啟用"),(0,o._)("th",null,"編輯")])],-1),u={key:0,class:"text-success"},c={key:1,class:"text-muted"},r={class:"btn-group w-100"},m=["onClick"],h=["onClick"];function g(e,t,a,g,_,b){const f=(0,o.up)("LoadingOverlay"),v=(0,o.up)("PaginationModel"),C=(0,o.up)("CouponModal"),w=(0,o.up)("DelModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(f,{active:_.isLoading},null,8,["active"]),(0,o._)("div",s,[(0,o._)("div",l,[(0,o._)("button",{type:"button",class:"btn btn-success w-100",onClick:t[0]||(t[0]=e=>b.openModal(!0))},"新增優惠券")])]),(0,o._)("div",i,[(0,o._)("table",d,[p,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.coupons,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",null,(0,n.zw)(t.title),1),(0,o._)("td",null,(0,n.zw)(`${t.percent}%`),1),(0,o._)("td",null,(0,n.zw)(e.$filters.inputDateType(t.due_date/1e3)),1),(0,o._)("td",null,[t.is_enabled?((0,o.wg)(),(0,o.iD)("span",u,"啟用")):((0,o.wg)(),(0,o.iD)("span",c,"未啟用"))]),(0,o._)("td",null,[(0,o._)("div",r,[(0,o._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>b.openModal(!1,t)},"編輯",8,m),(0,o._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>b.openDelModal(t)},"刪除",8,h)])])])))),128))])])]),(0,o.Wm)(v,{pages:_.pagination,onEmitPages:b.getCoupons},null,8,["pages","onEmitPages"]),(0,o.Wm)(C,{ref:"couponModal",coupon:_.tempCoupon,onUpdateCoupon:b.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,o.Wm)(w,{ref:"delModal",item:_.delItem,onDelItem:b.deleteCoupon},null,8,["item","onDelItem"])],64)}var _=a(9242);const b={class:"modal fade",ref:"modal"},f={class:"modal-dialog modal-sm",role:"document"},v={class:"modal-content border-0 mx-auto",style:{width:"300px"}},C=(0,o._)("div",{class:"modal-header bg-success text-white"},[(0,o._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,o._)("span",null,"新增優惠券")]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),w={class:"modal-body"},y={class:"mb-3"},k={for:"title",class:"form-label w-100"},M={class:"mb-3"},x={for:"percent",class:"form-label w-100"},$={key:0,class:"text-danger"},D={class:"mb-3"},U={for:"due_date",class:"form-label w-100"},S={class:"mb-3"},P={for:"code",class:"form-label w-100"},L={class:"mb-3"},N={class:"form-check"},Z={class:"form-check-label",for:"is_enabled"},K={class:"modal-footer"},O=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function W(e,t,a,n,s,l){return(0,o.wg)(),(0,o.iD)("div",b,[(0,o._)("div",f,[(0,o._)("div",v,[C,(0,o._)("div",w,[(0,o._)("div",y,[(0,o._)("label",k,[(0,o.Uk)("優惠券名稱 "),(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入名稱","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempCoupon.title=e)},null,512),[[_.nr,s.tempCoupon.title]])])]),(0,o._)("div",M,[(0,o._)("label",x,[(0,o.Uk)("折扣百分比 "),s.percentWarning?((0,o.wg)(),(0,o.iD)("span",$,"(不能小於 1)")):(0,o.kq)("",!0),(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",id:"percent",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.percent=e),onChange:t[2]||(t[2]=e=>s.percentWarning=!1),min:"1"},null,544),[[_.nr,s.tempCoupon.percent]])])]),(0,o._)("div",D,[(0,o._)("label",U,[(0,o.Uk)("到期日 "),(0,o.wy)((0,o._)("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入到期日","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempCoupon.due_date=e)},null,512),[[_.nr,s.tempCoupon.due_date]])])]),(0,o._)("div",S,[(0,o._)("label",P,[(0,o.Uk)("優惠碼 "),(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入優惠碼","onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.code=e)},null,512),[[_.nr,s.tempCoupon.code]])])]),(0,o._)("div",L,[(0,o._)("div",N,[(0,o._)("label",Z,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[5]||(t[5]=e=>s.tempCoupon.is_enabled=e)},null,512),[[_.e8,s.tempCoupon.is_enabled]]),(0,o.Uk)(" 是否啟用 ")])])])]),(0,o._)("div",K,[O,(0,o._)("button",{type:"button",class:"btn btn-success",onClick:t[6]||(t[6]=(...e)=>l.emitCoupon&&l.emitCoupon(...e))},"確認")])])])],512)}var T=a(1339),j={data(){return{modal:{},tempCoupon:{},percentWarning:!1}},props:{coupon:{type:Object,default(){return{}}}},watch:{coupon(){this.tempCoupon=JSON.parse(JSON.stringify(this.coupon)),this.tempCoupon.due_date=this.$filters.inputDateType(this.tempCoupon.due_date/1e3)}},mixins:[T.Z],methods:{emitCoupon(){if(this.tempCoupon.percent<1)return void(this.percentWarning=!0);const e=JSON.parse(JSON.stringify(this.tempCoupon)),t=new Date(e.due_date).getTime();e.due_date=t,this.$emit("update-coupon",e)}}},z=a(89);const I=(0,z.Z)(j,[["render",W]]);var J=I,V=a(4798),q=a(5239),H={data(){return{coupons:[],pagination:{},tempCoupon:{},isNew:!1,delItem:{},isLoading:!1}},components:{CouponModal:J,DelModal:V.Z,PaginationModel:q.Z},inject:["emitter","$httpMessageState"],methods:{getCoupons(e=1){let t="";t="previous"===e&&this.pagination.has_pre?this.pagination.current_page-1:"next"===e&&this.pagination.has_next?this.pagination.current_page+1:e;const a=`https://vue3-course-api.hexschool.io/api/cong-ren/admin/coupons?page=${t}`;this.isLoading=!0,this.$http.get(a).then((e=>{this.isLoading=!1,e.data.success&&(this.coupons=e.data.coupons,this.pagination=e.data.pagination)})).catch((e=>{console.log(e.response)}))},openModal(e,t){this.tempCoupon=e?{is_enabled:0,due_date:(new Date).getTime()}:JSON.parse(JSON.stringify(t)),this.isNew=e;const a=this.$refs.couponModal;a.showModal()},openDelModal(e){this.delItem=e;const t=this.$refs.delModal;t.showModal()},updateCoupon(e){this.tempCoupon=e;let t="https://vue3-course-api.hexschool.io/api/cong-ren/admin/coupon",a="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/cong-ren/admin/coupon/${e.id}`,a="put");const o=this.$refs.couponModal;this.isLoading=!0,this.$http[a](t,{data:this.tempCoupon}).then((e=>{this.isLoading=!1,e.data.success?(o.hideModal(),this.$httpMessageState("success","更新成功",e.data.message),this.getCoupons()):this.$httpMessageState("warning","更新失敗","請再檢查一次。")})).catch((()=>{this.$httpMessageState("danger","發生錯誤","請洽工程師。")}))},deleteCoupon(){const e=`https://vue3-course-api.hexschool.io/api/cong-ren/admin/coupon/${this.delItem.id}`;this.isLoading=!0,this.$http.delete(e).then((e=>{if(this.isLoading=!1,e.data.success){const t=this.$refs.delModal;t.hideModal(),this.getCoupons(),this.$httpMessageState("success","成功刪除優惠券",e.data.message)}else this.$httpMessageState("warning","刪除優惠券失敗",e.data.message)})).catch((()=>{this.$httpMessageState("danger","發生錯誤","請洽工程師。")}))}},created(){this.getCoupons()}};const Y=(0,z.Z)(H,[["render",g]]);var E=Y}}]);
//# sourceMappingURL=732.cd211da7.js.map