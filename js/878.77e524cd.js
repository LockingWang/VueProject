"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[878],{1878:function(t,e,s){s.r(e),s.d(e,{default:function(){return B}});var a=s(3396),n=s(7139),c=s(9242);const o={class:"bg-light"},i={class:"container bg-light"},l={class:"row justify-content-center"},d={class:"col-md-11 bg-white mt-5"},r={class:"row justify-content-center"},u={class:"col-md-8 mb-5 pt-3"},p=(0,a.uE)('<h5 class="text-center">訂購流程</h5><div class="row g-3 justify-content-center"><div class="col-sm-4" style="max-width:200px;"><div class="border border-3 border-danger rounded"><p class="text-center text-danger mb-0">確認購物車</p></div></div><div class="col-sm-4" style="max-width:200px;"><div class="border border-3 border-secondary rounded"><p class="text-center text-secondary mb-0">填寫訂購資訊</p></div></div><div class="col-sm-4" style="max-width:200px;"><div class="border border-3 border-secondary rounded"><p class="text-center text-secondary mb-0">建立訂單</p></div></div></div>',2),h={class:"my-3"},g=(0,a._)("h5",{class:"text-center mt-3 fw-bold"},"購物車",-1),_={class:"table align-middle"},b=(0,a._)("thead",{class:"table-light"},[(0,a._)("tr",null,[(0,a._)("th"),(0,a._)("th",null,"品名"),(0,a._)("th",{style:{width:"120px"}},"數量"),(0,a._)("th",{class:"text-center"},"單價")])],-1),m=["onClick"],x=(0,a._)("i",{class:"bi bi-trash"},null,-1),y=[x],v={key:0,class:"text-success"},w={class:"input-group input-group-sm"},k=["onUpdate:modelValue","onChange","disabled"],f={class:"input-group-text bg-warning"},C={class:"text-end"},$={key:0,class:"text-success mb-0"},D=(0,a._)("span",{style:{"font-size":"8px"}},"NTD",-1),L={key:1},q=(0,a._)("td",{colspan:"4"},[(0,a._)("p",{class:"text-center text-secondary"},"目前購物車內沒有商品...")],-1),U=[q],j={colspan:"2"},z=["disabled"],I=(0,a._)("td",{colspan:"1",class:"text-end"},"總計",-1),T={class:"text-end"},M=(0,a._)("span",{style:{"font-size":"8px"}},"NTD",-1),S={key:0},N=(0,a._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),V={class:"text-end text-success"},H=(0,a._)("span",{style:{"font-size":"8px"}},"NTD",-1),W={class:"d-flex justify-content-between"},Y={class:"input-group input-group-sm mb-1",style:{"max-width":"300px"}},E=["disabled"],G={key:0,class:"text-danger"};function K(t,e,s,x,q,K){const O=(0,a.up)("LoadingOverlay"),Z=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(O,{active:q.isLoading},null,8,["active"]),(0,a._)("div",o,[(0,a._)("div",i,[(0,a._)("div",l,[(0,a._)("div",d,[(0,a._)("div",r,[(0,a._)("div",u,[p,(0,a._)("div",h,[g,(0,a._)("table",_,[b,(0,a._)("tbody",null,[0==!q.cart.carts.length?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(q.cart.carts,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>K.removeCartItem(e.id)},y,8,m)]),(0,a._)("td",null,[(0,a.Uk)((0,n.zw)(e.product.title)+" ",1),e.coupon?((0,a.wg)(),(0,a.iD)("div",v," 已套用優惠券 ")):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("div",w,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control","aria-label":"buy number","onUpdate:modelValue":t=>e.qty=t,min:"1",onChange:t=>K.updateCart(e),disabled:this.status.loadingItem===e.id},null,40,k),[[c.nr,e.qty,void 0,{number:!0}]]),(0,a._)("div",f,"/ "+(0,n.zw)(e.product.unit),1)])]),(0,a._)("td",C,[e.coupon?((0,a.wg)(),(0,a.iD)("p",$,"折扣價")):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,n.zw)(t.$filters.currency(e.final_total))+" ",1),D])])))),128)):((0,a.wg)(),(0,a.iD)("tr",L,U))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[(0,a._)("td",j,[(0,a._)("button",{type:"button",class:"btn btn-outline-danger",onClick:e[0]||(e[0]=t=>K.removeCartItem("all")),disabled:0==q.cart.carts.length},"清空購物車",8,z)]),I,(0,a._)("td",T,[(0,a.Uk)((0,n.zw)(t.$filters.currency(q.cart.total))+" ",1),M])]),q.cart.final_total!==q.cart.total?((0,a.wg)(),(0,a.iD)("tr",S,[N,(0,a._)("td",V,[(0,a.Uk)((0,n.zw)(t.$filters.currency(q.cart.final_total))+" ",1),H])])):(0,a.kq)("",!0)])]),(0,a._)("div",W,[(0,a._)("div",Y,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","aria-label":"coupon_code","onUpdate:modelValue":e[1]||(e[1]=t=>q.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[c.nr,q.coupon_code]]),(0,a._)("button",{class:"btn btn-warning",type:"button",onClick:e[2]||(e[2]=(...t)=>K.textCheck&&K.textCheck(...t)),disabled:""===q.coupon_code||0==q.cart.carts.length}," 套用優惠碼 ",8,E)]),(0,a.Wm)(Z,{to:"/couponGame",class:"btn btn-outline-warning"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 優惠券專區")])),_:1})]),q.specialText?((0,a.wg)(),(0,a.iD)("p",G,"優惠碼不含特殊符號")):(0,a.kq)("",!0)]),0==!q.cart.carts.length?((0,a.wg)(),(0,a.j4)(Z,{key:0,to:"/userCheckout/userInfo",class:"btn btn-danger w-100"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 下一步 : 填寫訂購資訊")])),_:1})):(0,a.kq)("",!0)])])])])])])],64)}var O={data(){return{isLoading:!1,specialText:!1,cart:{carts:[]},coupon_code:"",status:{loadingItem:""}}},inject:["$httpMessageState"],methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/cong-ren/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,this.isLoading=!1}))},updateCart(t){let e=1;t.qty>=1&&(e=t.qty);const s=`https://vue3-course-api.hexschool.io/api/cong-ren/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:e};this.$http.put(s,{data:a}).then((()=>{this.isLoading=!1,this.status.loadingItem="",this.getCart()})).catch((t=>{console.log(t.response)}))},removeCartItem(t){let e="carts";"all"!==t&&(e=`cart/${t}`);const s=`https://vue3-course-api.hexschool.io/api/cong-ren/${e}`;this.isLoading=!0,this.$http.delete(s).then((()=>{this.isLoading=!1,this.$httpMessageState("success","刪除商品成功","快去尋找更適合的商品吧 ~ !"),this.getCart()})).catch((t=>{console.log(t.response),this.$httpMessageState("danger","發生錯誤","請聯繫工程師。")}))},addCouponCode(){this.coupon_code=this.coupon_code.trim();const t="https://vue3-course-api.hexschool.io/api/cong-ren/coupon",e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,t.data.success?(this.$httpMessageState("success","套用優惠券成功","確認商品後，點擊下一步填寫資料。"),this.getCart()):this.$httpMessageState("warning","套用優惠券失敗",t.data.message)})).catch((t=>{console.log(t),this.$httpMessageState("danger","發生錯誤","請聯繫工程師。")}))},textCheck(){const t=this.coupon_code.replace(/[`~!@#$%^&*()+=<>?:"{}|,./;'\\[\]·~！@#￥%……&*（）——\-+={}|《》？：“”【】、；‘’，。、]/g,"");t!==this.coupon_code?this.specialText=!0:(this.specialText=!1,this.addCouponCode())}},created(){this.getCart()}},Z=s(89);const A=(0,Z.Z)(O,[["render",K]]);var B=A}}]);
//# sourceMappingURL=878.77e524cd.js.map